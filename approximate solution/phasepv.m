    %PSENCIK&VARYCUK(2002)METHOD
function V=phasepv(A,N,vs,a)

D=sqrt(N(1)^2+N(2)^2);
r1=[N(1)*N(3),N(2)*N(3),N(3)^2-1]/D;
r2=[-N(2),N(1),0]/D;
 [PHI,~]=phi_cal(A,N,vs);
t1=r1*cosd(PHI)+r2*sind(PHI); t2=-r1*sind(PHI)+r2*cosd(PHI); 

c3= a(1,1)*N(1)^4 + 2*a(1,2)*N(1)^2*N(2)^2 + 2*a(1,3)*N(1)^2*N(3)^2 + 4*a(1,6)*N(1)^3*N(2) + a(2,2)*N(2)^4 + 2*a(2,3)*N(2)^2*N(3)^2 + 4*a(2,6)*N(1)*N(2)^3 + a(3,3)*N(3)^4 ...   %qP-wave phase velocity square
     + 4*a(3,6)*N(1)*N(2)*N(3)^2 + 4*a(4,4)*N(2)^2*N(3)^2+ 8*a(4,5)*N(1)*N(2)*N(3)^2 + 4*a(5,5)*N(1)^2*N(3)^2 + 4*a(6,6)*N(1)^2*N(2)^2;

c1= a(1,1)*N(1)^2*t1(1)^2 + a(2,2)*N(2)^2*t1(2)^2 + a(3,3)*N(3)^2*t1(3)^2 + 2*a(1,2)*N(1)*N(2)*t1(1)*t1(2) + 2*a(1,3)*N(1)*N(3)*t1(1)*t1(3) ...                                  %qS-wave square
     + 2*a(2,3)*N(2)*N(3)*t1(2)*t1(3) + 2*a(1,6)*(N(1)*N(2)*t1(1)^2+N(1)^2*t1(1)*t1(2)) + 2*a(2,6)*(N(2)^2*t1(1)*t1(2)+N(1)*N(2)*t1(2)^2) ...
     + 2*a(3,6)*(N(1)*N(3)*t1(2)*t1(3)+N(2)*N(3)*t1(1)*t1(3)) + 2*a(4,5)*(N(3)^2*t1(1)*t1(2)+N(1)*N(2)*t1(3)^2+N(1)*N(3)*t1(2)*t1(3)+N(2)*N(3)*t1(1)*t1(3)) ...
     + a(4,4)*(N(3)^2*t1(2)^2+N(2)^2*t1(3)^2+2*N(2)*N(3)*t1(2)*t1(3)) + a(5,5)*(N(3)^2*t1(1)^2+N(1)^2*t1(3)^2+2*N(1)*N(3)*t1(1)*t1(3)) ...
     + a(6,6)*(N(2)^2*t1(1)^2+N(1)^2*t1(2)^2+2*N(1)*N(2)*t1(1)*t1(2));

 c2= a(1,1)*N(1)^2*t2(1)^2 + a(2,2)*N(2)^2*t2(2)^2 + a(3,3)*N(3)^2*t2(3)^2 + 2*a(1,2)*N(1)*N(2)*t2(1)*t2(2) + 2*a(1,3)*N(1)*N(3)*t2(1)*t2(3) ...
     + 2*a(2,3)*N(2)*N(3)*t2(2)*t2(3) + 2*a(1,6)*(N(1)*N(2)*t2(1)^2+N(1)^2*t2(1)*t2(2)) + 2*a(2,6)*(N(2)^2*t2(1)*t2(2)+N(1)*N(2)*t2(2)^2) ...
     + 2*a(3,6)*(N(1)*N(3)*t2(2)*t2(3)+N(2)*N(3)*t2(1)*t2(3)) + 2*a(4,5)*(N(3)^2*t2(1)*t2(2)+N(1)*N(2)*t2(3)^2+N(1)*N(3)*t2(2)*t2(3)+N(2)*N(3)*t2(1)*t2(3)) ...
     + a(4,4)*(N(3)^2*t2(2)^2+N(2)^2*t2(3)^2+2*N(2)*N(3)*t2(2)*t2(3)) + a(5,5)*(N(3)^2*t2(1)^2+N(1)^2*t2(3)^2+2*N(1)*N(3)*t2(1)*t2(3)) ...
     + a(6,6)*(N(2)^2*t2(1)^2+N(1)^2*t2(2)^2+2*N(1)*N(2)*t2(1)*t2(2));

V(1)=sqrt(c3);  %qP
V2=sqrt(c1);  %qS1
V3=sqrt(c2);  %qS2

if (V2 > V3)
    V(2)=V2;
 elseif (V2 < V3)
       V(2)=V3;  
 end


if (V3 < V2)
    V(3)=V3;
 elseif (V3 > V2)
       V(3)=V2;  
end


